digraph BaremetalHost {
    Start [shape=house]
    Start -> Discovered [label="(without BMC access details)"]
    Start -> Registering [label="(with BMC access details)"]

    Discovered -> Registering [label="set BMC access details"]

    Registering -> Inspecting [label="NeedsHardwareInspection()"]
    Registering -> Deleting [label="!DeletionTimestamp.IsZero()"]
    Registering -> RegistrationError [label=error]

    Inspecting -> Deleting [label="!DeletionTimestamp.IsZero()"]
    Inspecting -> Ready [label="done"]

    RegistrationError -> Deleting [label="!DeletionTimestamp.IsZero()"]

    Ready [shape=doublecircle]
    Ready -> Deleting [label="!DeletionTimestamp.IsZero()"]
    Ready -> PreparingToProvision [label="NeedsProvisioning()"]

    PreparingToProvision -> ValidationError [label=error]
    PreparingToProvision -> MakingAvailable
    PreparingToProvision -> Deleting [label="!DeletionTimestamp.IsZero()"]

    ValidationError -> Deleting [label="!DeletionTimestamp.IsZero()"]

    MakingAvailable -> Provisioning
    MakingAvailable -> Deleting [label="!DeletionTimestamp.IsZero()"]

    Provisioning -> Deleting [label="!DeletionTimestamp.IsZero()"]
    Provisioning -> Provisioned [label=done]

    Provisioned [shape=doublecircle]
    Provisioned -> Deprovisioning [label="NeedsDeprovisioning()"]
    Provisioned -> Deleting [label="!DeletionTimestamp.IsZero()"]

    Deleting [shape=doublecircle]

    Deprovisioning -> Deleting [label="!DeletionTimestamp.IsZero()"]
    Deprovisioning -> PreparingToProvision [label="NeedsProvisioning()"]
}
